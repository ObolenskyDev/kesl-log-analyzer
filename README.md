# üõ°Ô∏è KESL Log Analyzer

![Python](https://img.shields.io/badge/Python-3.8%2B-3776AB?style=flat&logo=python)
![Bash](https://img.shields.io/badge/Shell-Bash-4EAA25?style=flat&logo=gnu-bash)
![Linux](https://img.shields.io/badge/Platform-Linux-FCC624?style=flat&logo=linux&logoColor=black)
![License](https://img.shields.io/badge/License-MIT-blue.svg)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ–∫ **Kaspersky Endpoint Security for Linux (KESL)** –∏ –ê–≥–µ–Ω—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ L3 Support, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ –∫–æ—Ä–Ω–µ–≤—ã—Ö –ø—Ä–∏—á–∏–Ω –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ (Root Cause Analysis) –≤ –ª–æ–≥–∞—Ö –æ–±—ä–µ–º–æ–º –æ—Ç 1 –ì–ë.

---

## üì∏ –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞
*(–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–æ–±—ã—Ç–∏—è)*

![Log Analysis Demo](analyzer_demo.png)

---

## üõ†Ô∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 1. `trace_analyzer.py` (Log Parser)
–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ª–æ–≥–æ–≤.
* **Smart Search:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (RegEx) –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: `Error`, `Fail`, `Critical`, `Exception`.
* **Context Awareness:** –í—ã–≤–æ–¥–∏—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π, –∞ **N —Å—Ç—Ä–æ–∫ –¥–æ –∏ –ø–æ—Å–ª–µ** —Å–æ–±—ã—Ç–∏—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–≤–µ–ª–æ –∫ —Å–±–æ—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä—ã–≤ —Å–µ—Ç–∏ *–ø–µ—Ä–µ–¥* –æ—à–∏–±–∫–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏).
* **High Performance:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—è –≤–µ—Å—å —Ñ–∞–π–ª –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å.

### 2. `log_rotate.sh` (Maintenance)
–°–∫—Ä–∏–ø—Ç –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ª–æ–≥–æ–≤.
* **Archiving:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∏ —Å–∂–∏–º–∞–µ—Ç (`gzip`) —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏, —á—Ç–æ–±—ã —ç–∫–æ–Ω–æ–º–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
* **Cleanup:** –£–¥–∞–ª—è–µ—Ç –∞—Ä—Ö–∏–≤—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Retention Policy).
* **Prevention:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ `/var/log`, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä–≤–∏—Å–∞ KESL.

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

```bash
# 1. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
sudo python3 trace_analyzer.py /var/log/kaspersky/kesl/kesl_launcher.log

# 2. –ó–∞–ø—É—Å–∫ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (—Å–æ–∑–¥–∞—Å—Ç –¥–µ–º–æ-–ª–æ–≥ –¥–ª—è —Ç–µ—Å—Ç–∞)
python3 trace_analyzer.py

# 3. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
sudo ./log_rotate.sh